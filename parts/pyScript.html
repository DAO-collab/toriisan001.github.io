<main>

    <h1>PyScript(v0.09)</h1>
    <p id="lastModified"></p>

    <hr>
    <details>
        <h2>使い方参考サイト</h2>
        <p><a href="https://pyscript.net/">pyscript公式【参考】</a></p>
        <p><a href="https://thilog.com/pyscript-sample-github-pages/">PyScriptで書いたスクリプトをGithub Pagesで動かしてみた【参考】</a></p>
        <p><a href="https://qiita.com/S_Kaji/items/293021fbcf35eab5102e">PyScriptを試してみました【参考】</a></p>
        <p><a href="https://krhb.hatenablog.com/entry/2022/06/01/PyScript%E3%81%A7%E5%8B%95%E7%9A%84Web%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%82%E3%81%A9%E3%81%8D%E3%82%92%E4%BD%9C%E3%82%8B">PyScriptで動的Webページもどきを作る【参考】</a></p>
        <p><a href="https://qiita.com/m-masataka/items/669bf05f76a8ca207739">PyScriptでぷよぷよ【参考】</a></p>
        <p><a href="https://qiita.com/S_Kaji/items/293021fbcf35eab5102e">PyScriptを試してみました【参考】</a></p>
        <p><a href="https://www.youtube.com/watch?v=ZniX7qbJs2E">【話題のPyScript！】HTMLファイルにPythonが書ける？！Webブラウザで動くPythonを解説！〜プログラム初心者用〜【参考】</a></p>
        <p>pyScriptはWebAssemblyを活用していてPythonをブラウザ上で実行できるようにするオープンソースソフトウェアらしい</p>
        <p>まだアルファ版でありプロダクションには使用しないよう勧めるらしい</p>
        <p>Chormeを使ったほうが良いらしい</p>

        <h2>使い方</h2>
        <h3>py-script</h3>
        <p>パイソン埋め込み</p>
        <pre>
            <code>
        &lt;py-script&gt;print(&quot;Hello, world!&quot;)&lt;/py-script&gt;
            </code>
        </pre>

        <h3>py-repl</h3>
        <p>ユーザーがパイソンを実行可能。コードを打ち込むと右端に緑の再生ボタンで実行可能らしい(Shift + Enterでも可)</p>
        
        <h3>py-env</h3>
        <p>環境変数らしい。以下例</p>
        <pre>
            <code>
        &lt;py-env&gt;
        - numpy
        - matplotlib
        - paths:
            - ./mymodule.py
        &lt;/py-env&gt;
            </code>
        </pre>

        <h2>パイソンコマンド(簡単なもの)</h2>
        <h3>文字列出力</h3>
        <pre>
            <code>
print(&quot;Hello, world!&quot;)
            </code>
        </pre>

        <h3>変数に設定。出力(文字列)</h3>
        <pre>
            <code>
name="shimada"
print("hello %s" %name)
            </code>
        </pre>
        <p>※エンターキーで改行が可能</p>

        <h3>コメント</h3>
        <p>ctl + / でコメントにできる</p>
        <pre>
            <code>
# commentを記載
            </code>
        </pre>
        
        <h3>ユーザーからの入力を受け付ける</h3>
        <pre>
            <code>
print("Your name?", end="")
name = input()
print("hello %s" %name)
            </code>
        </pre>
        <p>整数値の場合は%sではなく%iを使用する</p>

        <h3>printで改行させない</h3>
        <pre>
            <code>
print("Your name?", end="")
name = input()
            </code>
        </pre>

        <h3>ユーザーから数値を受け取って計算した値を表示</h3>
        <pre>
            <code>
print("Your number?", end="")
num = int(input())
print(num + 3)
            </code>
        </pre>
        <p>※input()で受け取った文字列は文字列なので数値化する必要がある。</p>

        <h3>if else文</h3>
        <pre>
            <code>
answer = 6

print("Your guess? ", end="")
guess = int(input())

if answer == guess:
    print("Bingo!")
else:
    print("Boo...")
            </code>
        </pre>
        <p>※スペース4つが字下げとなる</p>

        <h3>else if文</h3>
        <pre>
            <code>
answer = 6

print("Your guess? ", end="")
guess = int(input())

if answer == guess:
    print("Bingo!")
elif answer > guess:
    print("Bigger!!")
else:
    print("Smaller!!")
            </code>
        </pre>

        <h3>ランダムな数を読み込む</h3>
        <pre>
            <code>
import random
answer = random.randint(1, 10)

print("Your guess? ", end="")
guess = int(input())

if answer == guess:
    print("Bingo!")
elif answer > guess:
    print("Bigger!!")
else:
    print("Smaller!!")

print("[Answer: %i]" %answer)
            </code>
        </pre>

        <h3>正解するまでループさせる</h3>
        <pre>
            <code>
import random
answer = random.randint(1, 10)
while True:
    print("Your guess? ", end="")
    guess = int(input())
    
    if answer == guess:
        print("Bingo!")
        break
    elif answer > guess:
        print("Bigger!")
    else:
        print("Smaller!")
            </code>
        </pre>

        <h3>回数を保持する</h3>
        <pre>
            <code>
import random

answer = random.randint(1, 10)
count = 0

while True:
    print("Your guess? ", end="")
    guess = int(input())
    count += 1
    if answer == guess:
        print("Bingo! It took %i guesses" %count)
        break
    elif answer > guess:
        print("Bigger!")
    else:
        print("Smaller!")
            </code>
        </pre>

        <h3>関数(py-script)の呼び出し</h3>
        <pre>
            <code>
=====py-script=====
&lt;py-script&gt;
def func1(x):
    print(x + 10)
&lt;/py-script&gt;
=====py-repl=====
func1(10)
            </code>
        </pre>

        <h3>現在時刻の取得</h3>
        <pre>
            <code>
import datetime
print(datetime.datetime.now())
            </code>
        </pre>
        
        <h3>バージョン情報の取得</h3>
        <pre>
            <code>
import sys
print(f'バージョン: {sys.version_info}')
            </code>
        </pre>

        <h2>グラフを表示する</h2>
        <pre>
            <code>
=====py-script=====
def createPlot(fig):
pyscript.write('plot', fig)

=====py-repl(例)=====
import pandas as pd
import matplotlib.pyplot as plt
df = pd.DataFrame({
    '名前':['sato', 'saito', 'tanaka'],
    '年齢':[10, 32, 46]})

fig, ax = plt.subplots()
# x軸を名前、y軸を年齢に設定
ax.bar(df['名前'], df['年齢'])
writeOutputDiv(fig)
            </code>
        </pre>

        <h2>配列でforループ</h2>
        <pre>
            <code>
words = ['Japanese', 'English', 'French']
for w in words:
    print (w)
            </code>
        </pre>

        <h2>rangeでループ</h2>
        <pre>
            <code>
for num in range(5):
    print(num)
            </code>
        </pre>

        <h2>breakでループを抜ける</h2>
        <pre>
            <code>
for num in range(20):
    print(num)
    if num == 10:
            break
            </code>
        </pre>

        <h2>continueで次のループへ</h2>
        <pre>
            <code>
for num in range(2, 10):
    if num % 2 == 0:
        print("偶数 %i" %num)
        continue
    print("奇数 %i" %num)
            </code>
        </pre>

    </details>

    <hr>

    <details>
        <summary>外部ライブラリ(py-env)</summary>
        <pre>
            <code>
&lt;py-env&gt;
    - pandas
    - matplotlib
&lt;/py-env&gt;
            </pre>
        </pre>
    </details>

    <hr>

    <details>
        <summary>関数(py-script)</summary>
        <h2>10足して返す</h2>
        <pre>
            <code>
=====py-script=====
&lt;py-script&gt;
def func1(x):
    print(x + 10)
&lt;/py-script&gt;

=====py-repl(例)=====
func1(100)
            </code>
        </pre>
        <py-script>
def func1(x):
    print(x + 10)
        </py-script>

        <h2>divへ出力</h2>
        <pre>
            <code>
=====py-script=====
def writeOutputDiv(fig):
    pyscript.write('outputDiv', fig)

=====py-repl(例)=====
import pandas as pd
import matplotlib.pyplot as plt
df = pd.DataFrame({
    '名前':['sato', 'saito', 'tanaka'],
    '年齢':[10, 32, 46]})

fig, ax = plt.subplots()
# x軸を名前、y軸を年齢に設定
ax.bar(df['名前'], df['年齢'])
writeOutputDiv(fig)
            </code>
        </pre>
        <py-script>
def writeOutputDiv(item):
    pyscript.write('outputDiv', item)
        </py-script>

    </details>

    <hr>

    <h2>py-repl</h2>
    <div>
        <button style="margin-top: 10px;border: solid 1px #333;" type="button" id="clear">Output Clear</button>
    </div>
    <div id="outputDiv"></div>
    <div>
        <py-repl/>
    </div>
</main>
<div id="log"></div>
<script src="../js/util.js"></script>
<script src="../js/common.js"></script>
<script src="../js/config.js"></script>
 
<script defer src="https://pyscript.net/alpha/pyscript.js"></script>
<script>
'use strict';
    {
        // コンソールをクリア
        const clear = document.getElementById("clear");
        clear.addEventListener('click', () => {
            console.log('clear click');
            const output = document.getElementsByClassName('output')[0];
            // エラー時に付与されるクラスを除去
            output.classList.remove("bg-red-200");
            output.classList.remove("p-2");
            // コンソールを初期化
            while (output.firstChild) {
                output.removeChild(output.firstChild);
            }
            // outputDivを初期化
            const outputDiv = document.getElementById('outputDiv');
            while (outputDiv.firstChild) {
                outputDiv.removeChild(outputDiv.firstChild);
            }
        });
    }
</script>