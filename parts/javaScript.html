<main>
<h1>javaScript</h1>
<p id="lastModified"></p>

<h2>厳密なチェック</h2>
    <p>スクリプトの先頭にあるようにする必要があるらしい</p>
    <pre>
        <code>
'use strict';
        </code>
    </pre>

    <h2>まずブロックで囲むらしい</h2>
    <pre>
        <code>
'use strict';
{

}
        </code>
    </pre>

    <h2>ログを出力</h2>
    <pre>
        <code>
console.log('hogehoge');
        </code>
    </pre>
    <p>※Ｆ12キー -> Consoleタブからログを確認</p>

    <h2>要素の取得</h2>
    <p>getElementByの方がquerySelectorよりも速度が早いらしい</p>
    <p><a href="https://qiita.com/tomokichi_ruby/items/c3ed6f6edbd5078ddf70">【JavaScript】要素の取得方法(getElement、querySelector)</a></p>
    <h3>IDで取得(例)</h3>
    <p>documentオブジェクトに対してのみ使用可能</p>
    <p>id属性の値は、HTMLドキュメント上で唯一の値である必要がある</p>
    <p>同じidを持つ要素ノードが複数ある場合、基本的に一番はじめの要素ノードを取得する</p>
    <pre>
        <code>
const sample = document.getElementById('sample');
        </code>
    </pre>
    <h3>クラス名で取得(例)</h3>
    <pre>
        <code>
===HTML===
&lt;p class=&quot;sample&quot;&gt;サンプルテキスト１&lt;/p&gt;
===JavaScript===
const sample = document.getElementsByClassName('sample');
        </code>
    </pre>
    <h3>ID or クラス名で取得(例)</h3>
    <pre>
        <code>
===IDで取得===
===HTML===
&lt;p id=&quot;sample&quot;&gt;サンプルテキスト１&lt;/p&gt;
===JavaScript===
const sample = document.querySelector('#sample');

===クラス名で取得===
===HTML===
&lt;p class=&quot;sample&quot;&gt;サンプルテキスト１&lt;/p&gt;
===JavaScript===
const sample = document.querySelector('.sample');
// すべての要素に処理
sample.forEach(el => {
    // 処理...
});
document.querySelectorAll('.animate').forEach(el => {
    observer.observe(el);
});
        </code>
    </pre>
    <p>※1件しかなくても配列での取得となるため注意</p>
    <p><a href="https://9cubed.info/article/javascript/0029" target="_blank">【参考】JavaScript - アロー関数(ラムダ式)</a></p>


<h2>htmlのパーツを読み込む</h2>
    <pre>
    <code>
・jquery-3.6.1.min.jsを読み込む
&lt;script src=&quot;../js/jquery-3.6.1.min.js&quot;&gt;&lt;/script&gt;

・htmlParts.htmlを作成
&lt;div id=&quot;home&quot;&gt;
パーツ部分記述
&lt;/div&gt;

・htmlPage.html
以下の場所に配置
&lt;div id=&quot;home&quot;&gt;&lt;/div&gt;

    </code>
</pre>
    <p><a href="https://codelife.cafe/entry/2015/10/27/222803" target="_blank">【jQuery】htmlページをパーツごとに分けて読み込む方法</a></p>

<h2>HTML aside要素でサイドバーのアウトラインを作る</h2>
    <pre>
    <code>
・homePage.html
&lt;article&gt;
&lt;div class=&quot;side&quot;&gt;
    &lt;div id=&quot;side&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;content&quot;&gt;
    &lt;div id=&quot;home&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/article&gt;

・style.css
/* side */

.side {
    /* background-color: #ff838b; */
    width: 150px;
    text-align: center;
}

.content {
    /* background-color: #b3d874; */
    text-align: center;
    margin-left: 1px;
}

article {
    /* outline: 2px solid red; */
    margin: 0 auto;
    width: 1000px;
    display: flex;
}

    </code>
</pre>
    <p><a href="https://webukatu.com/wordpress/blog/27994/" target="_blank">HTML aside要素でサイドバーのアウトラインを作る</a></p>

    <h2>ファイルアクセスエラー</h2>
    <pre>
        「index.html:1 Access to XMLHttpRequest at 'file:///C:/xampp/htdocs/MyPortfolio/header.html' from origin 'null'
        has been blocked by CORS policy: Cross origin requests are only supported for protocol schemes: http, data,
        chrome, chrome-extension, chrome-untrusted, https, isolated-app.」
    </pre>
    <p>Chromeはhttpアクセスしかファイルへのアクセスを許可していない</p>
    <p>nodejsでローカルサーバーを立ち上げることで解決する</p>

    <h2>Intersection Observer APIを使用して浮かび上がらせるアニメーションを埋め込む</h2>
    <pre>
    <code>
===HEML===
&lt;div class=&quot;animate&quot;&gt;
&lt;/div&gt;

===CSS===
// 初期状態。少し下に配置して見えないようにする
.animate {
opacity: 0;
transform: translateY(40px);
transition: opacity .3s, transform .3s;
}

// 見えるようにする（javascriptでappearを付与させる）。animateクラスとappearがある状態。 
.animate.appear {
opacity: 1;
transform: none;
}

===JavaScript===
// Intersection Observer API

function inViewCallback(entries, obs) {
    entries.forEach(entry =&gt; {
        // 要素が画面と交差したかどうか判定
        if (!entry.isIntersecting) {
            return;
        }

        // 画面に要素が現れた場合はappearクラスを付与
        entry.target.classList.add(&#039;appear&#039;);
        // 一度付与された項目を監視対象から外す
        obs.unobserve(entry.target);
    });
}

// 特定の要素が画面に 20% くらい交差したときにこちらの callback の処理を実行
const inViewObserver = new IntersectionObserver(inViewCallback, {
    threshold: 0.2,
});

document.querySelectorAll(&#039;.animate&#039;).forEach(el =&gt; {
    inViewObserver.observe(el);
});
    </code>
</pre>

    <h2>テキストをクリップボードにコピー</h2>
    <pre>
    <code>
===HTML===
&lt;p class=&quot;button&quot; style=&quot;background-color: #efefef;&quot;&gt;#efefef&lt;/p&gt;

===JavaScript===
&lt;script&gt;
    $(function() {
        var button = document.getElementsByClassName(&quot;button&quot;);
        Array.from(button).forEach(element =&gt; {
            const bkupText = element.innerHTML;
            element.addEventListener(&#039;click&#039;, () =&gt; {
                navigator.clipboard.writeText(element.innerHTML);
                element.innerHTML = &#039;Copy OK！&#039;;
                setTimeout(() =&gt; element.innerHTML = bkupText, 500);
            });
        });
    });
&lt;/script&gt;
    </code>
</pre>
    <p><a href="https://don-bu-rakko.com/%E3%80%90%E8%B6%85%E7%B0%A1%E5%8D%98%E3%80%91javascript-%E3%81%A7-%E3%83%9C%E3%82%BF%E3%83%B3%E3%82%92%E6%8A%BC%E3%81%97%E3%81%9F%E3%82%89%E3%82%B3%E3%83%94%E3%83%BC-%E3%82%92%E5%AE%9F%E8%A3%85/"
            target="_blank">【１行だけ】ボタンをクリックしたら文章をコピーしたい！【JavaScript】</a></p>

<h2>ゼロ埋め関数</h2>
    <pre>
    <code>
function zeroPadding(no, digit) {
    return ('0'.repeat(digit) + no).slice( (-1 * digit) );
}
    </code>
</pre>

<h2>うるう年判定関数</h2>
    <pre>
    <code>
function isLeapYear(year) {
    return new Date(year, 2, 0).getDate() === 29;
}
    </code>
</pre>

<h2>毎秒実行</h2>
    <pre>
    <code>
setInterval(() => {

}, 1000);
    </code>
</pre>

    <h2>headerを固定する(Intersection Observer API)</h2>
    <pre>
    <code>
===HTML===
&lt;header&gt;
&lt;/header&gt;

===CSS===
header {
    padding: 16px 0;
    position: fixed;
    top: 0;
    width: 100%;
    transition: background-color .3s, box-shadow .3s;
    z-index: 1;
}

header.scrolled {
    background-color: rgba(255, 255, 255, .95);
    box-shadow: 0 0 4px rgba(0, 0, 0, .3);
}

===JavaScript===
    function onScrollCallback(entries) {
        entries.forEach(entry =&gt; {
            // 要素が画面と交差したかどうか判定
            if (!entry.isIntersecting) {
                header.classList.add(&#039;scrolled&#039;);
            } else {
                // 要素が画面に表示されている
                header.classList.remove(&#039;scrolled&#039;);
            }
        });
    }
    const header = document.querySelector(&#039;header&#039;);
    </code>
</pre>

<h2>クラスを付与する</h2>
    <pre>
    <code>
header.classList.add('scrolled');
    </code>
</pre>

<h2>クラスを除去する</h2>
    <pre>
    <code>
header.classList.remove('scrolled');
    </code>
</pre>

<h2>キーでイベントを発火</h2>
    <pre>
    <code>
// エンターキーでイベント発火
document.getElementById('k').onkeydown = function() {
    if (event.key === 'Enter') set();
};
    </code>
</pre>

<h2>WEBストレージ</h2>
    <pre>
    <code>
// データを保存
var k = document.getElementById("k").value;
if (k === '') return;
var v = document.getElementById("v").value;
storage.setItem(k, v);

// keyを指定してデータを取得
getItem(key)

// データを全てクリア
storage.clear();

// キーを指定してデータをクリア
storage.removeItem(k);

// i番目のキーを取得
var k = storage.key(i);
    </code>
</pre>

    <h2>js内で別のjsを読み込む。(モジュール)</h2>
    <p>type="module"を設定することでimportが使えるようになるらしい</p>
    <p>モジュール化するとonClickで関数が呼べなくなるらしい「ReferenceError: setaaa is not defined」function setaaa()</p>
    <p>上記回避策があるらしい<a href="https://elsammit-beginnerblg.hatenablog.com/entry/2022/05/19/234821">javascriptをtype="module"で読み出すとonclickイベントで関数がis not definedになる</a></p>
    <pre>
    <code>
=====html body部=====
&lt;script type=&quot;module&quot;src=&quot;../js/import1.js&quot;&gt;&lt;/script&gt;
=====import1.js======
import txt from "./import2.js" //これが必要になります
console.log(txt);
=====import1.js======
const txt = "Hello,World";
export default txt; //これが必要になります
    </code>
</pre>
    <p>以下のように直接埋め込むことも出来るらしい</p>
    <pre>
    <code>
&lt;!-- &lt;script type=&quot;module&quot;src=&quot;../js/import1.js&quot;&gt;&lt;/script&gt; --&gt;
&lt;script type=&quot;module&quot;&gt;
    &#039;use strict&#039;;
    import txt from &quot;../js/import2.js&quot; //これが必要になります
    {
        console.log(txt);
    };
&lt;/script&gt;
    </code>
</pre>

<h2>指定したエレメントのhtml要素を書き換える。(jQueryが必要)</h2>
<pre>
<code>
var notes_html = '';
games_html += `&lt;tr&gt;&lt;td id=&quot;id&quot;&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; id=&quot;title&quot;&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; id=&quot;body&quot;&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;datetime&quot; id=&quot;updated_at&quot; value=&quot;${updatedAt}&quot;&gt;&lt;/td&gt;&lt;/tr&gt;`;
games_html += &#039;&lt;/table&gt;&#039;;
$(&#039;#table&#039;).html(games_html);
</code>
</pre>

<h2>テキストボックスをクリックしたときに全選択状態にする</h2>
<pre>
<code>
&lt;input type=&quot;text&quot;onfocus=&quot;this.select();&quot;&gt;
</code>
</pre>

<h2>addEventListener</h2>
<a href="https://qiita.com/mzmz__02/items/873118fbd8723c44956d">【JavaScript】addEventListenerの使い方</a>
<pre>
<code>
strageSelect.addEventListener('change', (e) => {
    // 変数を更新
    localStorageObj.setItem('STRANGE_KBN', String(e.target.value));
    // ストレージタイトルの設定
    setStorageTitle();
    // ストレージ選択
    selectStrage();
    // 再読み込み
    show_result();
});
</code>
</pre>
※removeもあるらしい。document.removeEventListener('touchmove', disableScroll, { passive: false });

<h2>イベント無効化</h2>
<pre>
<code>
// to_topイベント
toTop.addEventListener('click', e => {
    // イベントを無効化(#(パウンド記号がついてしまうことを防ぐため))
    e.preventDefault();
    // ページ上部へ戻る
    window.scrollTo({
        top: 0,
        behavior: 'smooth',
    })
});
</code>
</pre>

<h2>ページ上部へ移動</h2>
<pre>
<code>
=====html=====
&lt;a href=&quot;#&quot; id=&quot;to_top&quot;&gt;
    &lt;i class=&quot;bi bi-arrow-up-square-fill&quot;&gt;&lt;/i&gt;
&lt;/a&gt;
// Intersection Observer API監視用
&lt;div id=&quot;target&quot;&gt;&lt;/div&gt;
=====css=====
#to_top {
    position: fixed;
    bottom: 16px;
    right: 16px;
    opacity: 0;
    transition: opacity .3s;
}
#to_top.scrolled {
    opacity: 1;
}
#to_top i {
    font-size: 32px;
    color:#22577a;
}
=====javascript=====
function onScrollCallback(entries) {
    entries.forEach(entry => {
        // 要素が画面と交差したかどうか判定
        if (!entry.isIntersecting) {
            toTop.classList.add('scrolled');
        } else {
            // 要素が画面に表示されている
            toTop.classList.remove('scrolled');
        }
    });
}
const toTop = document.getElementById('to_top');
// 特定の要素が画面に 20% くらい交差したときにこちらの callback の処理を実行
const onScrollObserver = new IntersectionObserver(onScrollCallback);
onScrollObserver.observe(document.getElementById('target'));

// to_topイベント
toTop.addEventListener('click', e => {
    // イベントを無効化(#(パウンド記号がついてしまうことを防ぐため))
    e.preventDefault();
    // ページ上部へ戻る(top0だと一番上まで行ってなかった)
    window.scrollTo({
        top: -500,
        behavior: 'smooth',
    })
});
</code>
</pre>

<h2>別のクリックイベントを呼び出す(click())</h2>
<pre>
<code>
close.addEventListener('click', () => {
    modal.classList.add('hidden');
    mask.classList.add('hidden');
});
mask.addEventListener('click', () => {
    // modal.classList.add('hidden');
    // mask.classList.add('hidden');
    close.click();
});
</code>
</pre>

<h2>スクロールを禁止にする</h2>
<pre>
<code>
=====CSS=====
/* スクロール禁止 */
.overflow-hidden {
    overflow: hidden;
}
=====JavaScript=====
// スクロール禁止付与
document.addEventListener('touchmove', disableScroll, { passive: false });
document.body.classList.add('overflow-hidden');

// スクロール禁止除去
document.removeEventListener('touchmove', disableScroll, { passive: false });
document.body.classList.remove('overflow-hidden');
</code>
</pre>
<a href="https://qumeru.com/magazine/278">CSSで画面をスクロールさせないようにする方法！【参考】</a>

<h2>JavaScriptのクラス（class）を理解する</h2>
<a href="https://techplay.jp/column/482">JavaScriptのクラス（class）を理解する【参考】</a>

<h2>【JavaScript】 Promiseの使い方</h2>
<a href="https://hidekazu-blog.com/javascript-fetch/#toc5">【JavaScript】Fetch API による非同期ネットワーク通信【参考】(プロミスオブジェクトの取得)</a>

<h2>【JavaScript】 async / await の使い方</h2>
<a href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Statements/async_function">mdn web docs 非同期関数【参考】</a>
<a href="https://laboradian.com/use-js-async-await/">【JavaScript】 async / await の使い方【参考】</a>
<a href="https://qiita.com/koedamon/items/9a486d4db5dd2614272d">JavaScriptのPromiseに関するまとめ（async/await含む）【参考】</a>

<h2>データ属性にデータを持たせる。</h2>
<pre>
    <code>
=====HTML=====
&lt;div class=&quot;mv&quot; data-youtube-id=&quot;Kjoe1vXlmxQ&quot;&gt;
&lt;/div&gt;
=====JavaScript=====
Array.from(mvs).forEach(el => {
console.log(el.dataset.youtubeId);
});
    </code>
</pre>

<h2>配列をforEachでループ</h2>
<pre>
    <code>
const array1 = ['a', 'b', 'c'];
array1.forEach(data => console.log(data));
    </code>
</pre>
<a href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach">mdn web docs Array.prototype.forEach()【参考】</a>

<h2>テキストエリアの項目を改行ごとに配列に設定</h2>
<pre>
    <code>
=====HTML=====
<textarea id="mvAddText" rows="1"></textarea>
=====JavaScript=====
const mvAddText = document.getElementById('mvAddText');
console.log(mvAddText.value.split(/\n/));
    </code>
</pre>
<a href="https://magazine.techacademy.jp/magazine/26943">JavaScriptでsplitメソッドを使ってテキストを改行で分割して配列に格納する方法を現役エンジニアが解説【初心者向け】【参考】</a>

<h2>URLをパース(プログラムで扱えるようなデータ構造の集合体に変換すること)(例)</h2>
<pre>
    <code>
var parser = new URL("https://www.youtube.com/watch?v=kRXn3Da895Y");
parser.host; // "https://www.youtube.com/watch"
var parser = new URL(url.value)
youtubeObj.youtubeId = parser.searchParams.get('v');
    </code>
</pre>
<a href="https://qiita.com/edisonthk/items/9e76784bedbd0cb969a5">javascriptでURLをパース【参考】</a>

<h2>【javascript】HTMLコレクションのループ方法</h2>
<p>HTMLコレクションはforeachが使えないが、配列に変換すると使えるようになるらしい。</p>
<pre>
    <code>
const fontSelect = document.getElementById("fontSelect");
Array.from(fontSelect.options).forEach(el => {
    console.log(el);
});
    </code>
</pre>
<a href="https://twotone.me/web/5087/">【javascript】HTMLコレクションのループ方法【参考】</a>

<h2>【JavaScript】特定の文字列を含むか否かを評価する方法</h2>
<pre>
    <code>
if (!e.path[0].className.match("operationMenuParts")) {
    operationMenu.classList.toggle("hidden");
}
    </code>
</pre>
<a href="https://hataworakuni.net/check-included-words-in-javascript">【JavaScript】特定の文字列を含むか否かを評価する方法【参考】</a>

<h2>【JavaScript】HTMLでbodyタグにonLoad属性を使う</h2>
<pre>
<code>
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;onLoadサンプル&lt;/title&gt;
&lt;/head&gt;
&lt;body onload=&quot;loadFunc()&quot;&gt;
    &lt;h1&gt;これはサンプルです&lt;/h1&gt;
&lt;/body&gt;
&lt;script&gt;
    function loadFunc() {
        alert(&quot;Hello World&quot;);
    }
&lt;/script&gt;
&lt;/html&gt;
</code>
</pre>
<a href="https://magazine.techacademy.jp/magazine/38326">【JavaScript】HTMLでbodyタグにonLoad属性を使う方法を現役エンジニアが解説【初心者向け】【参考】</a>

<h2>【JavaScript】楽譜を表示する</h2>
<p><a href="https://www.ne.jp/asahi/music/marinkyo/ml/abcjs-editor.html.ja">【参考】エディタ版 abcjs (旧版)</a></p>
<pre>
<code>
=====HTML=====
&lt;pre&gt;
&lt;span id=&quot;paper&quot;&gt;&lt;/span&gt;
&lt;/pre&gt;
=====JavaScript=====
&lt;script src=&quot;../js/musicTheory/abcjs-basic-min.js&quot;&gt;&lt;/script&gt;
&lt;script&quot;&gt;
    var abc = &quot;T: Cooley&#039;s\n&quot; +
        &quot;M: 4/4\n&quot; +
        &quot;L: 1/8\n&quot; +
        &quot;R: reel\n&quot; +
        &quot;K: Emin\n&quot; +
        &quot;|:D2|EB{c}BA B2 EB|~B2 AB dBAG|FDAD BDAD|FDAD dAFD|\n&quot; +
        &quot;EBBA B2 EB|B2 AB defg|afe^c dBAF|DEFD E2:|\n&quot; +
        &quot;|:gf|eB B2 efge|eB B2 gedB|A2 FA DAFA|A2 FA defg|\n&quot; +
        &quot;eB B2 eBgB|eB B2 defg|afe^c dBAF|DEFD E2:|&quot;;
        ABCJS.renderAbc(&quot;paper&quot;, abc);
&lt;/script&gt;
</script>
</code>
</pre>

<h2>jsからformを送信</h2>
<pre>
<code>
const checkboxes = document.querySelectorAll('input[type="checkbox"]');
checkboxes.forEach(checkbox => {
    checkbox.addEventListener('change', () => {
        // 親要素のformを送信
        checkbox.parentNode.submit();
    });
});
</code>
</pre>

</main>
<div id="log"></div>
<script src="../js/util.js"></script>
<script src="../js/config.js"></script>
<script src="../js/common.js"></script>
<script src="../js/musicTheory/abcjs-basic-min.js"></script>
