<main>
    <h1>Heroku</h1>
    <p id="lastModified"></p>

    <h2>Heroku環境作成(20230204時点)</h2>
    <details>
        <h3>以下でアカウントを作成</h3>
        <p><a href="https://signup.heroku.com/login">Heroku| Sign up</a></p>
        <figure>
            <img class="beside" src="../img/Heroku/Heroku環境作成(20230204時点)/アカウントを作成.PNG" alt="アカウントを作成.PNG">
            <figcaption>アカウントを作成.PNG</figcaption>
        </figure>
        <h3>登録したアドレスに以下のメールが届くのでリンクを踏む</h3>
        <pre>
Heroku にご登録いただきありがとうございます。 アカウントを有効にするには、登録から 30 日以内に次のリンクをクリックする必要があります。

https://id.heroku.com/account/accept/xxxxxxxxxxxxxxxxx

楽しんで、フィードバックをお寄せください。

Heroku チーム
https://heroku.com
        </pre>
            <h3>パスワードを作る</h3>
        <figure>
            <img class="beside" src="../img/Heroku/Heroku環境作成(20230204時点)/HerokuSetYourPassword.PNG" alt="HerokuSetYourPassword.PNG">
            <figcaption>HerokuSetYourPassword.PNG</figcaption>
        </figure>
        <pre>
=====以下翻訳=====
パスワードを作る
パスワードを作成し、Heroku アカウントにログインします。
新しいパスワードを作成する *
新しいパスワード
パスワードの確認 *
新しいパスワードを確認

パスワード要件
    8 文字以上である必要があります。
    文字、数字、および記号を含める必要があります。
    パスワードが一致する必要があります。
Heroku エクスペリエンスを最適化するために、新製品のリリース、技術コンテンツ、ヒントなどに関する最新情報を不定期に受け取りたいと考えています。 いつでも退会できます。
        </pre>
        <h3>CLICK HERE TO PROCEEDをクリック</h3>
        <h3>登録したアドレスとパスワードでHerokuにログインする</h3>
        <p><a href="https://id.heroku.com/login">Log in to your account</a></p>
        <figure>
            <img class="beside" src="../img/Heroku/Heroku環境作成(20230204時点)/LogInToYourAccount.PNG" alt="LogInToYourAccount.PNG">
            <figcaption>LogInToYourAccount.PNG</figcaption>
        </figure>
        <h3>Secure Your AccountでContinueをクリック</h3>
        <figure>
            <img class="beside" src="../img/Heroku/Heroku環境作成(20230204時点)/SecureYourAccount.PNG" alt="SecureYourAccount.PNG">
            <figcaption>SecureYourAccount.PNG</figcaption>
        </figure>
        <pre>
=====以下翻訳=====
アカウントを保護する
Heroku では、Heroku アカウントの保護を強化するために多要素認証 (MFA) に登録する必要があります。

Salesforce Authenticator、Google Authenticator、またはお気に入りのアプリを使用して登録します。

アカウント設定にアクセスして、バックアップ検証方法を作成することを忘れないでください。

詳細: アカウントを安全に保つ
        </pre>
        <h3>「検証方法を登録する」で「Salesforce Authenticator」を選択</h3>
        <figure>
            <img class="beside" src="../img/Heroku/Heroku環境作成(20230204時点)/検証方法を登録する.PNG" alt="検証方法を登録する.PNG">
            <figcaption>検証方法を登録する.PNG</figcaption>
        </figure>
        <h3>手持ちのスマホ(iOS または Android モバイルデバイス)にAuthenticatorをインストールする等指示に従い、2語の語句を入力して接続をクリック</h3>
        <figure>
            <img class="beside" src="../img/Heroku/Heroku環境作成(20230204時点)/SalesforceAuthenticatorに接続する.PNG" alt="SalesforceAuthenticatorに接続する.PNG">
            <figcaption>SalesforceAuthenticatorに接続する.PNG</figcaption>
        </figure>
        <h3>スマホ側で接続をクリック(いつからか2段階認証が必須になっている)</h3>
        <h3>利用規約を読んで受け入れるを選択</h3>
        <figure>
            <img class="beside" src="../img/Heroku/Heroku環境作成(20230204時点)/利用規約.PNG" alt="利用規約.PNG">
            <figcaption>利用規約.PNG</figcaption>
        </figure>
        <h3>「Create a new app」をクリック</h3>
        <figure>
            <img class="beside" src="../img/Heroku/Heroku環境作成(20230204時点)/CreatANewApp.PNG" alt="CreatANewApp.PNG">
            <figcaption>CreatANewApp.PNG</figcaption>
        </figure>
        <h3>「Create New App」設定を入力して「Create App」をクリック</h3>
        <p>App name:アプリ名(例:toriisan-php-001)(使用できる文字は英字小文字( a-z )と数字( 0-9 )とハイフン( - )のみらしい)</p>
        <p>Choose a region:United Status</p>
        <p>Add this app to a pipeline:pipelineを設定する場合は追加したらいいのだろうか。私は追加しなかった。(開発、検証、本番など複数の環境を管理する場合はあったほうが便利らしい。ボタン押すだけでデプロイできるなど)</p>
        <p>You must add a payment method to create an app:2022年11月28日よりHerokuの無料プランが無くなった。ここの「Add credit card」で支払方法を登録する。「Subscribe to Eco」で$5/月で1000時間（約41.6日）使えるEco Dynoプランに登録</p>
        <figure>
            <img class="beside" src="../img/Heroku/Heroku環境作成(20230204時点)/CreatANewApp_設定.PNG" alt="CreatANewApp_設定.PNG">
            <figcaption>CreatANewApp_設定.PNG</figcaption>
        </figure>
        <h3>「Open app」をクリックすれば、環境にアクセスできる</h3>
        <p><a href="https://toriisan-php-001.herokuapp.com/">(例)鳥居涼太のポートフォリオサイト_PHP</a></p>
        <figure>
            <img class="beside" src="../img/Heroku/Heroku環境作成(20230204時点)/OpenApp.PNG" alt="OpenApp.PNG">
            <figcaption>OpenApp.PNG</figcaption>
        </figure>
        <figure>
            <img class="beside" src="../img/Heroku/Heroku環境作成(20230204時点)/HerokuWelcomeToYourNewApp!.PNG" alt="HerokuWelcomeToYourNewApp!.PNG">
            <figcaption>HerokuWelcomeToYourNewApp!.PNG</figcaption>
        </figure>
        <h3>Heroku CLIをインストール</h3>
        <p><a href="https://devcenter.heroku.com/ja/articles/heroku-cli#install-the-heroku-cli">Heroku CLI</a></p>
        <p>PCが64ビットだったので64ビットを選択</p>
        <figure>
            <img class="beside" src="../img/Heroku/Heroku環境作成(20230204時点)/HerokuCLIをインストール.PNG" alt="HerokuCLIをインストール.PNG">
            <figcaption>HerokuCLIをインストール.PNG</figcaption>
        </figure>
        <p>以下インストール済み。「heroku -v」でバージョンを確認</p>
        <figure>
            <img class="beside" src="../img/Heroku/Heroku環境作成(20230204時点)/herokuCLIInstall.PNG" alt="herokuCLIInstall.PNG">
            <figcaption>herokuCLIInstall.PNG</figcaption>
        </figure>
        <h3>「Setting」タブをクリック。「Heroku git URL」を確認する。</h3>
        <figure>
            <img class="beside" src="../img/Heroku/Heroku環境作成(20230204時点)/HerokuGitURL.PNG" alt="HerokuGitURL.PNG">
            <figcaption>HerokuGitURL.PNG</figcaption>
        </figure>
        <h3>「cd ${作業用ディレクトリ}」コマンドで作業用ディレクトに移動して「git clone ${Heroku git URL}」でクローン。Heroku Login画面に移動が促されるので移動してログインする必要がある。</h3>
        <p><a href="https://devcenter.heroku.com/ja/articles/heroku-cli#install-the-heroku-cli">Heroku CLI</a></p>
        <p>以下クローンを実行後</p>
        <figure>
            <img class="beside" src="../img/Heroku/Heroku環境作成(20230204時点)/clone.PNG" alt="clone.PNG">
            <figcaption>clone.PNG</figcaption>
        </figure>
        <p>ローカルリポジトリが作成された。ここにソースをおいてコミット。プッシュすることでデプロイが出来る。</p>
        <figure>
            <img class="beside" src="../img/Heroku/Heroku環境作成(20230204時点)/ローカルリポジトリ.PNG" alt="ローカルリポジトリ.PNG">
            <figcaption>ローカルリポジトリ.PNG</figcaption>
        </figure>
        <h3>試しにソースをデプロイしてみる</h3>
        <p>例「C:\xampp8.2\htdocs\toriisan-php-001」ディレクトリに「index.php」を作成。「add」でgitに追加。コミット。プッシュ先「Heroku git URL」へプッシュ。</p>
<pre>
<code>
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;ja&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
    &lt;title&gt;Document&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;?php echo &#039;Helo World!&#039; ?&gt;
&lt;/body&gt;
&lt;/html&gt;
</code>
</pre>
        <p>環境へアクセスしてみると、ソースが反映されている。何も入れなくてもPHPが動いている？？？</p>
        <figure>
            <img class="beside" src="../img/Heroku/Heroku環境作成(20230204時点)/HelloWorld.PNG" alt="HelloWorld.PNG">
            <figcaption>HelloWorld.PNG</figcaption>
        </figure>
    </details>

    <h2>Heroku Command Line Interface (CLI) </h2>
    <p>Heroku Command Line Interface (CLI) を使用すると、Heroku アプリをターミナルから直接、作成および管理できます。Heroku CLI は、Heroku を利用する際に必要なツールです。</p>
    <h3>ログイン</h3>
<pre>
<code>
heroku loign
</code>
</pre>

    <h3>bash参照</h3>
<pre>
<code>
heroku run bash -a ${アプリ名}
</code>
</pre>

    <h3>REDISインスタンスの情報を確認</h3>
<pre>
<code>
heroku redis:info -a ${アプリ名}
</code>
</pre>

    <h3>環境情報を確認</h3>
<pre>
<code>
heroku config -a ${アプリ名}
</code>
</pre>

    <h3>postgres</h3>
    <h4>postgres接続</h4>
<pre>
<code>
heroku pg:psql -app ${アプリ名}
</code>
</pre>
    <h4>DBから取得</h4>
<pre>
<code>
\o output.csv // 記録開始
\a // エンコードだっけ
\f ',' // 区切り文字の設定
\i ${ファイル名} // ファイル読み込み。そのままsql書いてもいい
\o // ファイル出力
</code>
</pre>
    <h4>UTF-8に変換(変換しないとDB取得が出来ないことがあった)</h4>
<pre>
<code>
chcp 65001
</code>
</pre>
    <h4>テーブル定義の確認</h4>
<pre>
<code>
\d ${テーブル名}
</code>
</pre>

    <h3>スタックの確認</h3>
<pre>
<code>
heroku stack --ap ${アプリ名}
</code>
</pre>

    <h3>アドオンを確認</h3>
<pre>
<code>
heroku addons
>Owning App        Add-on                       Plan            Price  State
>────────────────  ───────────────────────────  ──────────────  ─────  ───────
>toriisan-php-001  cleardb-perpendicular-xxxxx  cleardb:ignite  free   created
</code>
</pre>

    <h3>アプリのコンフィグを確認</h3>
<pre>
<code>
heroku config --app toriisan-php-001
=== toriisan-php-001 Config Vars
CLEARDB_DATABASE_URL: mysql://${DB_USERNAME}:${DB_PASSWORD}@${DB_HOST}/${DB_DATABASE}?reconnect=true
</code>
</pre>

    <h3>MySQL接続</h3>
    <p>事前にmysqlをインストールしてパスを通しておく必要がある。</p>
    <h4>ローカル</h4>
<pre>
<code>
=====cod=====
mysql -u toriisan -D test -p
toriisanmysqlpass
</code>
</pre>
    <h4>heroku</h4>
<pre>
<code>
heroku config --app toriisan-php-001
=== toriisan-php-001 Config Vars
CLEARDB_DATABASE_URL: mysql://${DB_USERNAME}:${DB_PASSWORD}@${DB_HOST}/${DB_DATABASE}?reconnect=true
</code>
</pre>
</main>
<div id="log"></div>
<script src="../js/util.js"></script>
<script src="../js/common.js"></script>
<script src="../js/config.js"></script>
 